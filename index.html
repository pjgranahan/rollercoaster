<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  <title>Bitcoin Rollercoaster</title>
</head>
<body>
<!--   <div>
    <button id="ride" type="button">RIDE THE RIDE</button>
  </div> -->
  <button id="start">RIDE THE RIDE</button>
  <button id="stop">STOP I'M GETTING SICK</button>
	<div id="chartContainer" style="height: 300px; width: 100%;">
	</div>
  <script src="canvasjs.min.js"></script>
  <script src="jquery-2.1.1.min.js"></script>
    <script type="text/javascript">
  
    window.onload = function () {

      var dps = []; // dataPoints
      
      CanvasJS.addColorSet("bitcoin_colors",
              [//colorSet Array
              "#FF9900"              
              ]);

      var chart = new CanvasJS.Chart("chartContainer",{
        title :{
          text: "Bitcoin Rollercoaster"
        },
        creditText: "",
        creditHref: "",      
        colorSet: "bitcoin_colors",
        data: [{
          type: "line",
          dataPoints: dps 
        }],
        axisX:{
          // title: "Minutes",
          // gridThickness: 1,
          tickLength: 0,
          // prefix: "test"
          interval: 100,
        },
        axisY:{
          interlacedColor: "#F8F1E4",
          tickLength: 10,
          prefix: "$",
          gridThickness: 0
        }
      });

      var xVal = 0;
      var yVal = 100; 
      var updateInterval = 20;
      var dataLength = 50; // number of dataPoints visible at any point

      var updateChart = function (count) {
        count = count || 1;
        // count is number of times loop runs to generate random dataPoints.
        
        for (var j = 0; j < count; j++) { 
          yVal = yVal +  Math.round(5 + Math.random() *(-5-5));
          dps.push({
            x: xVal,
            y: yVal
          });
          xVal++;
        };

        if (dps.length > dataLength) {
          dps.shift();        
        }
        
        chart.render();
        // context.clearRect(0,0,1,1);
            
      };
      
      // generates first set of dataPoints
        // updateChart(dataLength); 
          
      // update chart after specified time. 
     // setInterval(function(){updateChart();}, updateInterval); 

      var globalID;

      function animate() {
        // alert("I am an alert box!");
        updateChart()
        // chart.render()
        globalID = requestAnimationFrame(animate);
      }
      // requestAnimationFrame(animate);


      $("#start").on("click", function() {
        // alert("START");
        globalID = requestAnimationFrame(animate);
        $("#start").toggle()
        $("#stop").toggle()
      });

      $("#stop").on("click", function() {
        // alert("STOP");
        cancelAnimationFrame(globalID);
        $("#start").toggle()
        $("#stop").toggle()
      });
      $("#stop").toggle()


     // var runButton = document.getElementById('ride');

     //  runButton.addEventListener('click', function() {
     //      alert(dps[dps.length-1].y);
     //  }, false);


    }
  </script>
</body>
</html>
